<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üïäÔ∏è Vigen√®re Cipher App</title>
  <meta name="theme-color" content="#1a1a2e" />
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon.png" type="image/png" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #12121a;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #00ffe5;
    }
    nav {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
    }
    nav button {
      flex: 1;
      padding: 12px;
      margin: 5px;
      background-color: #00ffe5;
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      font-size: 16px;
    }
    .page { display: none; }
    .active { display: block; }
    .section {
      background-color: #1f1f2e;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0, 255, 229, 0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #ccc;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #2a2a3a;
      color: #fff;
    }
    button.action {
      margin-top: 15px;
      padding: 12px;
      width: 100%;
      font-size: 16px;
      background-color: #00ffe5;
      border: none;
      color: #000;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
    }
    .result {
      margin-top: 15px;
      font-weight: bold;
      color: #00ff88;
      word-wrap: break-word;
    }
    @media (max-width: 600px) {
      h1 { font-size: 1.4rem; }
      nav button { font-size: 14px; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>

</head>
<body>

<h1>üïäÔ∏è Vigen√®re Cipher App</h1>

<nav>
  <button onclick="showPage('encryptPage')">üîê Encrypt</button>
  <button onclick="showPage('decryptPage')">üîì Decrypt</button>
</nav>

<div class="page active" id="encryptPage">
  <div class="section">
    <h2>Encrypt Message</h2>
    <label for="encryptText">Text to Encrypt (Emojis Allowed):</label>
    <input type="text" id="encryptText" placeholder="e.g. HELLO üòÑ" />
    <label for="encryptKey">Key:</label>
    <input type="text" id="encryptKey" placeholder="e.g. NICE" />
    <button class="action" onclick="encrypt()">Encrypt</button>
    <button class="action" onclick="clearFields('encryptText', 'encryptKey', 'encryptResult')">üßπ Clear</button>
    <div class="result" id="encryptResult"></div>
  </div>
</div>

<div class="page" id="decryptPage">
  <div class="section">
    <h2>Decrypt Message</h2>
    <label for="decryptText">Text to Decrypt:</label>
    <input type="text" id="decryptText" placeholder="e.g. ZQPR üòÑ" />
    <label for="decryptKey">Key:</label>
    <input type="text" id="decryptKey" placeholder="e.g. NICE" />
    <button class="action" onclick="decrypt()">Decrypt</button>
    <button class="action" onclick="clearFields('decryptText', 'decryptKey', 'decryptResult')">üßπ Clear</button>
    <div class="result" id="decryptResult"></div>
  </div>
</div>

  <div>
  <button onclick="startCamera()">üì∏ Scan Text</button>
  <video id="video" width="100%" autoplay playsinline style="display:none;"></video>
  <canvas id="canvas" style="display:none;"></canvas>
  <button onclick="captureText()">üì§ Capture & Scan</button>
</div>


<script>
  function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  function vigenere(text, key, mode = 'encrypt') {
    key = key.toUpperCase().replace(/[^A-Z]/g, '');
    let result = '', keyIndex = 0;
    for (let i = 0; i < text.length; i++) {
      let char = text[i], upperChar = char.toUpperCase();
      if (upperChar >= 'A' && upperChar <= 'Z') {
        let t = upperChar.charCodeAt(0) - 65;
        let k = key.charCodeAt(keyIndex % key.length) - 65;
        let r = mode === 'encrypt' ? (t + k) % 26 : (t - k + 26) % 26;
        let newChar = String.fromCharCode(r + 65);
        result += (char === char.toLowerCase()) ? newChar.toLowerCase() : newChar;
        keyIndex++;
      } else {
        result += char;
      }
    }
    return result;
  }

  function encrypt() {
    const text = document.getElementById('encryptText').value;
    const key = document.getElementById('encryptKey').value;
    document.getElementById('encryptResult').textContent = "Encrypted: " + vigenere(text, key, 'encrypt');
  }

  function decrypt() {
    const text = document.getElementById('decryptText').value;
    const key = document.getElementById('decryptKey').value;
    document.getElementById('decryptResult').textContent = "Decrypted: " + vigenere(text, key, 'decrypt');
  }

  function clearFields(textId, keyId, resultId) {
    document.getElementById(textId).value = '';
    document.getElementById(keyId).value = '';
    document.getElementById(resultId).textContent = '';
  }

  // Register Service Worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js');
    });
  }
</script>

  <script>
  let video = document.getElementById('video');
  let canvas = document.getElementById('canvas');

function startCamera() {
  navigator.mediaDevices.getUserMedia({
    video: { facingMode: { exact: "environment" } } // force back camera
  })
  .then(stream => {
    video.srcObject = stream;
    video.style.display = 'block';
  })
  .catch(err => {
    alert('Back camera not available. Trying default camera...');
    // fallback to any available camera
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
        video.style.display = 'block';
      })
      .catch(err => alert('Camera error: ' + err));
  });
}


  function captureText() {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext('2d').drawImage(video, 0, 0);

    Tesseract.recognize(
      canvas,
      'eng',
      { logger: m => console.log(m) }
    ).then(({ data: { text } }) => {
      alert("Scanned Text:\n" + text.trim());
      stopCamera();

      // Auto-fill scanned text into encrypt or decrypt form
      const encryptInput = document.getElementById('encryptInput');
      const decryptInput = document.getElementById('decryptInput');

      if (encryptInput) encryptInput.value = text.trim();
      if (decryptInput) decryptInput.value = text.trim();
    });
  }

  function stopCamera() {
    let stream = video.srcObject;
    if (stream) {
      let tracks = stream.getTracks();
      tracks.forEach(track => track.stop());
    }
    video.style.display = 'none';
  }
</script>


</body>
</html>


